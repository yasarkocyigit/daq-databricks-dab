# Databricks Apps configuration for the M2M Communication Example
#
# This app demonstrates app-to-app communication by calling the
# Builder App's agent API using M2M OAuth authentication.
#
# Prerequisites:
#   1. Deploy the Builder App first
#   2. Grant this app's service principal CAN USE on the Builder App
#   3. Update BUILDER_APP_URL below with the actual URL

# The command to start the app. This is specific to this example app and
# must match the entrypoint module. No changes needed unless you rename app.py.
command:
  - "uvicorn"
  - "app:app"
  - "--host"
  - "0.0.0.0"
  - "--port"
  - "$DATABRICKS_APP_PORT"

env:
  - name: BUILDER_APP_URL
    value: "https://<workspace>.cloud.databricks.com/apps/<builder-app-name>"

  # Optional: Cross-workspace configuration
  # Set these to call a builder app on a different workspace.
  # If not set, the app uses same-workspace auto-auth (default).
  #
  # Option A: Use a PAT or token for the remote workspace
  # - name: BUILDER_DATABRICKS_HOST
  #   value: "https://other-workspace.cloud.databricks.com"
  # - name: BUILDER_DATABRICKS_TOKEN
  #   value: "<pat-for-remote-workspace>"
  #
  # Option B: Use SP credentials (more production-appropriate)
  # - name: BUILDER_DATABRICKS_HOST
  #   value: "https://other-workspace.cloud.databricks.com"
  # - name: BUILDER_DATABRICKS_CLIENT_ID
  #   value: "<sp-client-id>"
  # - name: BUILDER_DATABRICKS_CLIENT_SECRET
  #   value: "<sp-client-secret>"
