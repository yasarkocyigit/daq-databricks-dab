gold_model:
  name: dim_promotion
  type: materialized_view
  description: "Special offers / promotions dimension"

  source_tables:
    - silver.specialoffer

  sql: |
    SELECT
      SpecialOfferID AS promotion_key,
      Description AS promotion_description,
      DiscountPct AS discount_percent,
      Type AS promotion_type,
      Category AS promotion_category,
      StartDate AS start_date,
      EndDate AS end_date,
      MinQty AS min_quantity,
      MaxQty AS max_quantity,
      is_active,
      current_timestamp() AS etl_timestamp
    FROM LIVE.specialoffer

  quality:
    expectations:
      - name: "promotion_key_not_null"
        constraint: "promotion_key IS NOT NULL"
        action: fail
